# FA Auction Security Configuration

# ===========================================
# Security Headers
# ===========================================
<IfModule mod_headers.c>
    # Prevent clickjacking attacks
    Header always set X-Frame-Options "SAMEORIGIN"

    # Prevent MIME type sniffing
    Header always set X-Content-Type-Options "nosniff"

    # Enable XSS filtering in browsers
    Header always set X-XSS-Protection "1; mode=block"

    # Control referrer information
    Header always set Referrer-Policy "strict-origin-when-cross-origin"

    # Permissions Policy (restrict browser features)
    Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"

    # Strict Transport Security - Force HTTPS (uncomment when HTTPS is enabled in production)
    # NOTE: Only enable this when you have a valid SSL certificate installed
    # Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"

    # Content Security Policy - adjust as needed for your application
    # This is a moderately strict policy that allows inline styles (needed for many apps)
    Header always set Content-Security-Policy "default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data:; font-src 'self'; connect-src 'self'; frame-ancestors 'self';"
</IfModule>

# ===========================================
# Block access to sensitive files/folders
# ===========================================

# Block .git folder
RedirectMatch 404 /\.git

# Block access to sensitive file types
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|sql|bak|config|env)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# Block access to composer files
<FilesMatch "^(composer\.json|composer\.lock|package\.json|package-lock\.json)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>

# ===========================================
# PHP Security Settings (if supported)
# ===========================================
<IfModule mod_php.c>
    # Disable error display (should be off in production)
    php_flag display_errors Off
    php_flag display_startup_errors Off

    # Enable session strict mode
    php_flag session.use_strict_mode On

    # Secure session cookies
    php_flag session.cookie_httponly On
    php_flag session.cookie_secure Off
    php_value session.cookie_samesite "Lax"
</IfModule>

# ===========================================
# Additional Security Measures
# ===========================================

# Disable directory browsing
Options -Indexes

# Disable server signature
ServerSignature Off

# Prevent access to backup and source files
<FilesMatch "(\.(bak|backup|old|orig|save|swp|tmp)|~)$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order allow,deny
        Deny from all
    </IfModule>
</FilesMatch>
